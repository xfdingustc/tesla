<!doctype html>
<html>
<head>
    <title>React Transform Boilerplate</title>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <style>
        body {
            overflow: hidden;
        }

        body, #root, .hachi-ban {
            background: transparent;
        }

        .hachi-ban {
            height: 100vh;
            width: 100vw;
        }
    </style>
    <script>
        //https://cdnjs.cloudflare.com/ajax/libs/es6-promise/4.0.5/es6-promise.auto.js
        //this script should before all packing ,and cant load by webpack for the promise in webpack is not work in the QT webkit browser.arc
    !function(a,b){"object"==typeof exports&&"undefined"!=typeof module?module.exports=b():"function"==typeof define&&define.amd?define(b):a.ES6Promise=b()}(this,function(){"use strict";function a(a){return"function"==typeof a||"object"==typeof a&&null!==a}function b(a){return"function"==typeof a}function c(a){U=a}function d(a){V=a}function e(){return function(){return process.nextTick(j)}}function f(){return"undefined"!=typeof T?function(){T(j)}:i()}function g(){var a=0,b=new Y(j),c=document.createTextNode("");return b.observe(c,{characterData:!0}),function(){c.data=a=++a%2}}function h(){var a=new MessageChannel;return a.port1.onmessage=j,function(){return a.port2.postMessage(0)}}function i(){var a=setTimeout;return function(){return a(j,1)}}function j(){for(var a=0;a<S;a+=2){var b=_[a],c=_[a+1];b(c),_[a]=void 0,_[a+1]=void 0}S=0}function k(){try{var a=require,b=a("vertx");return T=b.runOnLoop||b.runOnContext,f()}catch(a){return i()}}function l(a,b){var c=arguments,d=this,e=new this.constructor(n);void 0===e[ba]&&G(e);var f=d._state;return f?!function(){var a=c[f-1];V(function(){return D(f,e,a,d._result)})}():z(d,e,a,b),e}function m(a){var b=this;if(a&&"object"==typeof a&&a.constructor===b)return a;var c=new b(n);return v(c,a),c}function n(){}function o(){return new TypeError("You cannot resolve a promise with itself")}function p(){return new TypeError("A promises callback cannot return that same promise.")}function q(a){try{return a.then}catch(a){return fa.error=a,fa}}function r(a,b,c,d){try{a.call(b,c,d)}catch(a){return a}}function s(a,b,c){V(function(a){var d=!1,e=r(c,b,function(c){d||(d=!0,b!==c?v(a,c):x(a,c))},function(b){d||(d=!0,y(a,b))},"Settle: "+(a._label||" unknown promise"));!d&&e&&(d=!0,y(a,e))},a)}function t(a,b){b._state===da?x(a,b._result):b._state===ea?y(a,b._result):z(b,void 0,function(b){return v(a,b)},function(b){return y(a,b)})}function u(a,c,d){c.constructor===a.constructor&&d===l&&c.constructor.resolve===m?t(a,c):d===fa?y(a,fa.error):void 0===d?x(a,c):b(d)?s(a,c,d):x(a,c)}function v(b,c){b===c?y(b,o()):a(c)?u(b,c,q(c)):x(b,c)}function w(a){a._onerror&&a._onerror(a._result),A(a)}function x(a,b){a._state===ca&&(a._result=b,a._state=da,0!==a._subscribers.length&&V(A,a))}function y(a,b){a._state===ca&&(a._state=ea,a._result=b,V(w,a))}function z(a,b,c,d){var e=a._subscribers,f=e.length;a._onerror=null,e[f]=b,e[f+da]=c,e[f+ea]=d,0===f&&a._state&&V(A,a)}function A(a){var b=a._subscribers,c=a._state;if(0!==b.length){for(var d=void 0,e=void 0,f=a._result,g=0;g<b.length;g+=3)d=b[g],e=b[g+c],d?D(c,d,e,f):e(f);a._subscribers.length=0}}function B(){this.error=null}function C(a,b){try{return a(b)}catch(a){return ga.error=a,ga}}function D(a,c,d,e){var f=b(d),g=void 0,h=void 0,i=void 0,j=void 0;if(f){if(g=C(d,e),g===ga?(j=!0,h=g.error,g=null):i=!0,c===g)return void y(c,p())}else g=e,i=!0;c._state!==ca||(f&&i?v(c,g):j?y(c,h):a===da?x(c,g):a===ea&&y(c,g))}function E(a,b){try{b(function(b){v(a,b)},function(b){y(a,b)})}catch(b){y(a,b)}}function F(){return ha++}function G(a){a[ba]=ha++,a._state=void 0,a._result=void 0,a._subscribers=[]}function H(a,b){this._instanceConstructor=a,this.promise=new a(n),this.promise[ba]||G(this.promise),R(b)?(this._input=b,this.length=b.length,this._remaining=b.length,this._result=new Array(this.length),0===this.length?x(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&x(this.promise,this._result))):y(this.promise,I())}function I(){return new Error("Array Methods must be provided an Array")}function J(a){return new H(this,a).promise}function K(a){var b=this;return new b(R(a)?function(c,d){for(var e=a.length,f=0;f<e;f++)b.resolve(a[f]).then(c,d)}:function(a,b){return b(new TypeError("You must pass an array to race."))})}function L(a){var b=this,c=new b(n);return y(c,a),c}function M(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function N(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function O(a){this[ba]=F(),this._result=this._state=void 0,this._subscribers=[],n!==a&&("function"!=typeof a&&M(),this instanceof O?E(this,a):N())}function P(){var a=void 0;if("undefined"!=typeof global)a=global;else if("undefined"!=typeof self)a=self;else try{a=Function("return this")()}catch(a){throw new Error("polyfill failed because global object is unavailable in this environment")}var b=a.Promise;if(b){var c=null;try{c=Object.prototype.toString.call(b.resolve())}catch(a){}if("[object Promise]"===c&&!b.cast)return}a.Promise=O}var Q=void 0;Q=Array.isArray?Array.isArray:function(a){return"[object Array]"===Object.prototype.toString.call(a)};var R=Q,S=0,T=void 0,U=void 0,V=function(a,b){_[S]=a,_[S+1]=b,S+=2,2===S&&(U?U(j):aa())},W="undefined"!=typeof window?window:void 0,X=W||{},Y=X.MutationObserver||X.WebKitMutationObserver,Z="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),$="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,_=new Array(1e3),aa=void 0;aa=Z?e():Y?g():$?h():void 0===W&&"function"==typeof require?k():i();var ba=Math.random().toString(36).substring(16),ca=void 0,da=1,ea=2,fa=new B,ga=new B,ha=0;return H.prototype._enumerate=function(){for(var a=this.length,b=this._input,c=0;this._state===ca&&c<a;c++)this._eachEntry(b[c],c)},H.prototype._eachEntry=function(a,b){var c=this._instanceConstructor,d=c.resolve;if(d===m){var e=q(a);if(e===l&&a._state!==ca)this._settledAt(a._state,b,a._result);else if("function"!=typeof e)this._remaining--,this._result[b]=a;else if(c===O){var f=new c(n);u(f,a,e),this._willSettleAt(f,b)}else this._willSettleAt(new c(function(b){return b(a)}),b)}else this._willSettleAt(d(a),b)},H.prototype._settledAt=function(a,b,c){var d=this.promise;d._state===ca&&(this._remaining--,a===ea?y(d,c):this._result[b]=c),0===this._remaining&&x(d,this._result)},H.prototype._willSettleAt=function(a,b){var c=this;z(a,void 0,function(a){return c._settledAt(da,b,a)},function(a){return c._settledAt(ea,b,a)})},O.all=J,O.race=K,O.resolve=m,O.reject=L,O._setScheduler=c,O._setAsap=d,O._asap=V,O.prototype={constructor:O,then:l,catch:function(a){return this.then(null,a)}},O.polyfill=P,O.Promise=O,O}),ES6Promise.polyfill();
   </script>
</head>
<body>
<div id="root" style="width: 100vw" class="hachi-ban">
</div>

<script type="text/javascript" src="api.js"></script></body>

<script>
    // For on-the-fly (e.g. live view) usage ONLY
    /***  -start- deprecated api*/
    var setState = hachi.gauge.setBuffer.bind(hachi.gauge);
    var update = hachi.gauge.setStateByBuffer.bind(hachi.gauge);
    /***  -end- deprecated api*/
    /***  -start- new api*/
    var setRawData = hachi.gauge.setRawData.bind(hachi.gauge);
    var setDefaultLayout = hachi.gauge.setDefaultLayout.bind(hachi.gauge);
    var getCurrentLayout = hachi.gauge.getCurrentLayout.bind(hachi.gauge);
    var initDefaultGauge = hachi.gauge.initDefaultGauge.bind(hachi.gauge);
    /***  -end- new api*/
    var setGauge = hachi.gauge.setGauge.bind(hachi.gauge);
    var setTheme = hachi.gauge.setTheme.bind(hachi.gauge);

    var setTimePoints = hachi.gauge.setTimePoints.bind(hachi.gauge);
    var setPlayTime = hachi.gauge.setPlayTime.bind(hachi.gauge);
    var isShowMap = function () {
        return !!document.getElementsByClassName('map-core')[0]
    }
    var getMapCorePosition = function () {
        setRawData({
                    lat: 1,
                    lng: 1
                }
        )
        var tmp = document.getElementsByClassName('map-core')[0].getBoundingClientRect();
        return tmp;
        //output:  {top: 43.59375, right: 1774.8294677734375, bottom: 305.6391906738281, left: 1512.7840576171875, width: 262.0454406738281}
    };
    // For static (e.g. transcoding) usage ONLY
    var injectRawData = hachi.gauge.injectRawData.bind(hachi.gauge);
    var updateByFrame = hachi.gauge.updateByFrame.bind(hachi.gauge);
    // Utils
    var isMapLoaded = hachi.gauge.isMapLoaded.bind(hachi.gauge);
    var isThemeLoaded = hachi.gauge.isThemeLoaded.bind(hachi.gauge)
    var numericMonthDate = hachi.numericMonthDate;
    /**

     //the default behavior of every gauge is hidden.  you must init gauge when there is no style config or raw data,you can use this method to show the default gauge ,even when the data is empty.
     //当没有设置style数据或者任何rawdata数据的时候,你必须调用此函数,来显示默认的gauge ,因为所有的gauge默认都是隐藏的.
     //if you apply the gauge style config and set rawData to gauge,this method is useless.
     //如果你已经设置了 gauge 的style 并且设置了gauge的数值,那么没有必要使用它
     initDefaultGauge();

     //reset layout,you needn't reset the layout by youself ,you can just use this method to achieve it.
     //将gauge 设置为默认的布局,可以通过此函数来实现.
     setDefaultLayout();
     //setDefaultLayout();等价于:
     setState({
                showSpeedThrottle: 'L',//options:(L,M,S)
                showRpm: 'M',//options:(L,M,S)
                showAmbient: 'S',//options:(L,M,S)
                showTimeDate: 'S',//options:(S)
                showGforce: 'L',//options:(L,M,S)
                showRollPitch: 'M',//options:(L,M,S)
                showGps: 'L',//options:(L,M)
                showPsi: "S",//options:(L,M,S)
        });
     update()
     //change theme of dashboard
     //改变dashboard的主题
     setTheme("neo");
     setState({theme: "neo"});update();
     //change the gauge size
     //改变gauge 的大小
     setGauge("Rpm", "S");
     setState({showRpm: "S"});update();




     //update data: in previous version ,you use the setState to update the data.but now it is recommended to use setRawData,for setState method wont auto hide or show gauge.
     //更新数据的时候我们建议你使用setRawData 而不是setState.因为使用setState不能自动隐藏 gauge.
     // setRawData will clear the previous status:
     // setRawData({A:a,B:b,C:c});   |
     // setRawData({B:b});           | == setState({B:b});update();
     // setRawData({A:a,B:b,C:c});   |
     // setRawData({B:b,C:c});       | ==setState({B:b,C:c});update();
     // following command will hide all gauge expect rpm gauge
     // setRawData({rpm: 88.8})
     // 等价于:
     // setState({rpm: 88.8, mph: null, throttle: null, psi: null, gforceBA: null, gforceLR: null, lat:null, lng:null, latLngList:null, roll:null, pitch: null, ambient:null, time:null, gpsSpeed: null, obdSpeed: null})
     setRawData({
        rpm: 88.8
    })
     // following command will hide all gauge expect speed gauge,
     setRawData({
        mph: 66.6,
        gpsSpeed: 55.5, // we will use gps speed,obd speed and mph will not work;
        obdSpeed: 77.8,
    })
     setRawData({
        rpm: 88.8,
        mph: 88.8, //deprecated ,please set gpsSpeed and obdSpeed
        throttle: 88.8,
        whp: 88.8,
        psi: 88.8,
        gforceBA: 88.8,
        gforceLR: 88.8,
        lat: 8.8,
        lng: 8.8,
        latLngList: [[42.360701, 21], [42.460701, 29], [41.360701, 27], [40.360701, 21]],
        roll: 88.8,
        pitch: 88.8,
        ambient: {
            tempF: 0,
            windSpeedMiles: 0,
            pressure: 88.8,
            humidity: 0,
            weatherCode: 88
        },
        time: new Date(),
        gpsSpeed: 88.8, // gps speed unit is km/h  it will auto transformed to mph
        obdSpeed: 77.8,// gps speed unit is km/h  it will auto transformed to mph
    })
     setState({time: new Date('December 17, 1995 03:24:00')});
     setState({time: numericMonthDate('12 17, 1995 03:24:00')});
     setState({rpm: 2000});
     setState({lng: 121});
     setState({showMap: false});
     update();// you can update all config  to make it effect in the last line

     //api for countDown:
        //init the countDount time points
            setState({countTimePoints:{t1:123123,t2:123145,t3:3343535,t4:5565657567,t5:67887655,t6:8564332232}});update()
            setTimePoints({t1:123123,t2:123145,t3:3343535,t4:5565657567,t5:67887655,t6:8564332232}) //timestamp(Milliseconds) offset
        // video play process currenttime,(Milliseconds)
            setPlayTime(123)
            setState({playTime:123});update()
            setState({showCountDown:"S"});update()


     // use this to fix the acc value if the video is rotated
        setState({ifRotate:true});update()

     //change the unit for speed and 0-60 racing unit
        setState({perUnit: "mph"})
        setState({perUnit: "kmh"})

     */


    /**
     * server transcoding test demo :
     injectRawData([
     {
         "duration": 2000,
         "url": "http://ws.waylens.com:8999/api/v3/moments/raw?guid=0c0651a3-1b46-4701-a434-d6f6166ec43e_00094ae800001388&offset=0&count=2000&start=2000&freq=0"
     }
     ],20
     );
     updateByFrame(102);
     */
</script>
</html>